First implementation. Tested in CMSSW_10_2_0. To be finalized
